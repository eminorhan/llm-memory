10/23/2022 15:10:21 - INFO - __main__ - Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda
Mixed precision type: no

10/23/2022 15:10:21 - WARNING - datasets.builder - Using custom data configuration default-a1fa35a57715e192
Downloading and preparing dataset json/default to /home/eo41/.cache/huggingface/datasets/json/default-a1fa35a57715e192/0.0.0/e6070c77f18f01a5ad4551a8b7edfba20b8438b7cad4d94e6ad9378022ce4aab...
Downloading data files:   0%|          | 0/2 [00:00<?, ?it/s]Downloading data files: 100%|██████████| 2/2 [00:00<00:00, 3214.03it/s]
Extracting data files:   0%|          | 0/2 [00:00<?, ?it/s]Extracting data files: 100%|██████████| 2/2 [00:00<00:00, 358.56it/s]
0 tables [00:00, ? tables/s]                            0 tables [00:00, ? tables/s]                            Dataset json downloaded and prepared to /home/eo41/.cache/huggingface/datasets/json/default-a1fa35a57715e192/0.0.0/e6070c77f18f01a5ad4551a8b7edfba20b8438b7cad4d94e6ad9378022ce4aab. Subsequent calls will reuse this data.
  0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 237.29it/s]
Traceback (most recent call last):
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/huggingface_hub/utils/_errors.py", line 213, in hf_raise_for_status
    response.raise_for_status()
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/models/opt_2.7b_data_0_0.0003_1/resolve/main/config.json

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/utils/hub.py", line 409, in cached_file
    resolved_file = hf_hub_download(
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/huggingface_hub/file_download.py", line 1053, in hf_hub_download
    metadata = get_hf_file_metadata(
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/huggingface_hub/file_download.py", line 1359, in get_hf_file_metadata
    hf_raise_for_status(r)
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/huggingface_hub/utils/_errors.py", line 242, in hf_raise_for_status
    raise RepositoryNotFoundError(message, response) from e
huggingface_hub.utils._errors.RepositoryNotFoundError: 401 Client Error. (Request ID: -UiqTzmMw3gpUQrJqugol)

Repository Not Found for url: https://huggingface.co/models/opt_2.7b_data_0_0.0003_1/resolve/main/config.json.
Please make sure you specified the correct `repo_id` and `repo_type`.
If the repo is private, make sure you are authenticated.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/scratch/eo41/lm-recognition-memory/evaluate.py", line 275, in <module>
    main()
  File "/scratch/eo41/lm-recognition-memory/evaluate.py", line 143, in main
    config = AutoConfig.from_pretrained(args.model_name_or_path)
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/models/auto/configuration_auto.py", line 770, in from_pretrained
    config_dict, unused_kwargs = PretrainedConfig.get_config_dict(pretrained_model_name_or_path, **kwargs)
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/configuration_utils.py", line 558, in get_config_dict
    config_dict, kwargs = cls._get_config_dict(pretrained_model_name_or_path, **kwargs)
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/configuration_utils.py", line 613, in _get_config_dict
    resolved_config_file = cached_file(
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/utils/hub.py", line 424, in cached_file
    raise EnvironmentError(
OSError: models/opt_2.7b_data_0_0.0003_1 is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo with `use_auth_token` or log in with `huggingface-cli login` and pass `use_auth_token=True`.
Fatal error condition occurred in /opt/vcpkg/buildtrees/aws-c-io/src/9e6648842a-364b708815.clean/source/event_loop.c:72: aws_thread_launch(&cleanup_thread, s_event_loop_destroy_async_thread_fn, el_group, &thread_options) == AWS_OP_SUCCESS
Exiting Application
################################################################################
Stack trace:
################################################################################
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x200af06) [0x14b6583cff06]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x20028e5) [0x14b6583c78e5]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x1f27e09) [0x14b6582ece09]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x200ba3d) [0x14b6583d0a3d]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x1f25948) [0x14b6582ea948]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x200ba3d) [0x14b6583d0a3d]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x1ee0b46) [0x14b6582a5b46]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x194546a) [0x14b657d0a46a]
/lib64/libc.so.6(+0x39b0c) [0x14b668393b0c]
/lib64/libc.so.6(on_exit+0) [0x14b668393c40]
/lib64/libc.so.6(__libc_start_main+0xfa) [0x14b66837d49a]
python() [0x588fae]
/opt/slurm/data/slurmd/job26191595/slurm_script: line 23: 817761 Aborted                 (core dumped) python -u /scratch/eo41/lm-recognition-memory/evaluate.py --model_name_or_path "models/${SP}" --seen_file "data/recognition-memory-experimental-data/seen_${EX}.json" --unseen_file "data/recognition-memory-experimental-data/unseen_${EX}.json" --per_device_eval_batch_size 1 --output_dir "evals/expt1" --save_prefix ${SP} --block_size 128 --overwrite_cache
10/23/2022 15:10:29 - INFO - __main__ - Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda
Mixed precision type: no

10/23/2022 15:10:29 - WARNING - datasets.builder - Using custom data configuration default-a1fa35a57715e192
10/23/2022 15:10:29 - WARNING - datasets.builder - Found cached dataset json (/home/eo41/.cache/huggingface/datasets/json/default-a1fa35a57715e192/0.0.0/e6070c77f18f01a5ad4551a8b7edfba20b8438b7cad4d94e6ad9378022ce4aab)
  0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 384.83it/s]
Traceback (most recent call last):
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/huggingface_hub/utils/_errors.py", line 213, in hf_raise_for_status
    response.raise_for_status()
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/models/opt_2.7b_data_0_0.0003_2/resolve/main/config.json

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/utils/hub.py", line 409, in cached_file
    resolved_file = hf_hub_download(
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/huggingface_hub/file_download.py", line 1053, in hf_hub_download
    metadata = get_hf_file_metadata(
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/huggingface_hub/file_download.py", line 1359, in get_hf_file_metadata
    hf_raise_for_status(r)
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/huggingface_hub/utils/_errors.py", line 242, in hf_raise_for_status
    raise RepositoryNotFoundError(message, response) from e
huggingface_hub.utils._errors.RepositoryNotFoundError: 401 Client Error. (Request ID: hW2xDYtOfMvZlhovdfjaS)

Repository Not Found for url: https://huggingface.co/models/opt_2.7b_data_0_0.0003_2/resolve/main/config.json.
Please make sure you specified the correct `repo_id` and `repo_type`.
If the repo is private, make sure you are authenticated.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/scratch/eo41/lm-recognition-memory/evaluate.py", line 275, in <module>
    main()
  File "/scratch/eo41/lm-recognition-memory/evaluate.py", line 143, in main
    config = AutoConfig.from_pretrained(args.model_name_or_path)
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/models/auto/configuration_auto.py", line 770, in from_pretrained
    config_dict, unused_kwargs = PretrainedConfig.get_config_dict(pretrained_model_name_or_path, **kwargs)
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/configuration_utils.py", line 558, in get_config_dict
    config_dict, kwargs = cls._get_config_dict(pretrained_model_name_or_path, **kwargs)
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/configuration_utils.py", line 613, in _get_config_dict
    resolved_config_file = cached_file(
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/utils/hub.py", line 424, in cached_file
    raise EnvironmentError(
OSError: models/opt_2.7b_data_0_0.0003_2 is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo with `use_auth_token` or log in with `huggingface-cli login` and pass `use_auth_token=True`.
Fatal error condition occurred in /opt/vcpkg/buildtrees/aws-c-io/src/9e6648842a-364b708815.clean/source/event_loop.c:72: aws_thread_launch(&cleanup_thread, s_event_loop_destroy_async_thread_fn, el_group, &thread_options) == AWS_OP_SUCCESS
Exiting Application
################################################################################
Stack trace:
################################################################################
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x200af06) [0x14b6278fff06]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x20028e5) [0x14b6278f78e5]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x1f27e09) [0x14b62781ce09]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x200ba3d) [0x14b627900a3d]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x1f25948) [0x14b62781a948]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x200ba3d) [0x14b627900a3d]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x1ee0b46) [0x14b6277d5b46]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x194546a) [0x14b62723a46a]
/lib64/libc.so.6(+0x39b0c) [0x14b6378c3b0c]
/lib64/libc.so.6(on_exit+0) [0x14b6378c3c40]
/lib64/libc.so.6(__libc_start_main+0xfa) [0x14b6378ad49a]
python() [0x588fae]
/opt/slurm/data/slurmd/job26191595/slurm_script: line 23: 817863 Aborted                 (core dumped) python -u /scratch/eo41/lm-recognition-memory/evaluate.py --model_name_or_path "models/${SP}" --seen_file "data/recognition-memory-experimental-data/seen_${EX}.json" --unseen_file "data/recognition-memory-experimental-data/unseen_${EX}.json" --per_device_eval_batch_size 1 --output_dir "evals/expt1" --save_prefix ${SP} --block_size 128 --overwrite_cache
10/23/2022 15:10:34 - INFO - __main__ - Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda
Mixed precision type: no

10/23/2022 15:10:34 - WARNING - datasets.builder - Using custom data configuration default-a1fa35a57715e192
10/23/2022 15:10:34 - WARNING - datasets.builder - Found cached dataset json (/home/eo41/.cache/huggingface/datasets/json/default-a1fa35a57715e192/0.0.0/e6070c77f18f01a5ad4551a8b7edfba20b8438b7cad4d94e6ad9378022ce4aab)
  0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 386.64it/s]
Traceback (most recent call last):
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/huggingface_hub/utils/_errors.py", line 213, in hf_raise_for_status
    response.raise_for_status()
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/models/opt_2.7b_data_0_0.0003_4/resolve/main/config.json

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/utils/hub.py", line 409, in cached_file
    resolved_file = hf_hub_download(
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/huggingface_hub/file_download.py", line 1053, in hf_hub_download
    metadata = get_hf_file_metadata(
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/huggingface_hub/file_download.py", line 1359, in get_hf_file_metadata
    hf_raise_for_status(r)
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/huggingface_hub/utils/_errors.py", line 242, in hf_raise_for_status
    raise RepositoryNotFoundError(message, response) from e
huggingface_hub.utils._errors.RepositoryNotFoundError: 401 Client Error. (Request ID: zFouDtqIfegDQZ1myabAT)

Repository Not Found for url: https://huggingface.co/models/opt_2.7b_data_0_0.0003_4/resolve/main/config.json.
Please make sure you specified the correct `repo_id` and `repo_type`.
If the repo is private, make sure you are authenticated.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/scratch/eo41/lm-recognition-memory/evaluate.py", line 275, in <module>
    main()
  File "/scratch/eo41/lm-recognition-memory/evaluate.py", line 143, in main
    config = AutoConfig.from_pretrained(args.model_name_or_path)
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/models/auto/configuration_auto.py", line 770, in from_pretrained
    config_dict, unused_kwargs = PretrainedConfig.get_config_dict(pretrained_model_name_or_path, **kwargs)
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/configuration_utils.py", line 558, in get_config_dict
    config_dict, kwargs = cls._get_config_dict(pretrained_model_name_or_path, **kwargs)
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/configuration_utils.py", line 613, in _get_config_dict
    resolved_config_file = cached_file(
  File "/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/utils/hub.py", line 424, in cached_file
    raise EnvironmentError(
OSError: models/opt_2.7b_data_0_0.0003_4 is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo with `use_auth_token` or log in with `huggingface-cli login` and pass `use_auth_token=True`.
Fatal error condition occurred in /opt/vcpkg/buildtrees/aws-c-io/src/9e6648842a-364b708815.clean/source/event_loop.c:72: aws_thread_launch(&cleanup_thread, s_event_loop_destroy_async_thread_fn, el_group, &thread_options) == AWS_OP_SUCCESS
Exiting Application
################################################################################
Stack trace:
################################################################################
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x200af06) [0x14aa3336df06]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x20028e5) [0x14aa333658e5]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x1f27e09) [0x14aa3328ae09]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x200ba3d) [0x14aa3336ea3d]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x1f25948) [0x14aa33288948]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x200ba3d) [0x14aa3336ea3d]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x1ee0b46) [0x14aa33243b46]
/scratch/eo41/miniconda3/envs/llm/lib/python3.9/site-packages/pyarrow/libarrow.so.900(+0x194546a) [0x14aa32ca846a]
/lib64/libc.so.6(+0x39b0c) [0x14aa43331b0c]
/lib64/libc.so.6(on_exit+0) [0x14aa43331c40]
/lib64/libc.so.6(__libc_start_main+0xfa) [0x14aa4331b49a]
python() [0x588fae]
/opt/slurm/data/slurmd/job26191595/slurm_script: line 23: 817964 Aborted                 (core dumped) python -u /scratch/eo41/lm-recognition-memory/evaluate.py --model_name_or_path "models/${SP}" --seen_file "data/recognition-memory-experimental-data/seen_${EX}.json" --unseen_file "data/recognition-memory-experimental-data/unseen_${EX}.json" --per_device_eval_batch_size 1 --output_dir "evals/expt1" --save_prefix ${SP} --block_size 128 --overwrite_cache
